<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Amazon NoSQL Solutions</title>

    <!-- Bootstrap -->
    <!-- <link href="/css/bootstrap.min.css" rel="stylesheet"> -->
    <!-- <link href="/css/pygments.css" rel="stylesheet"> -->
    <link href="/css/all.css" rel="stylesheet">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="container">
      <div class="row page-header">
        <div class="col-md-12">
          <!--nav>
            <ul class="nav nav-pills pull-right">
              <li role="presentation" class="active"><a href="#">Home</a></li>
              <li role="presentation"><a href="#">About</a></li>
              <li role="presentation"><a href="#">Contact</a></li>
            </ul>
          </nav-->
          <h3 class="text-muted"><a href="/">vim, git, aws and other three-letter words</a></h3>
        </div>
      </div>
      <div class="row">
          <div class="col-md-12">
              <h1>Amazon NoSQL Solutions</h1>
          </div>
      </div>
      <div class="row">
          <div class="col-md-12">
              <p>Amazon provides following <a href="https://en.wikipedia.org/wiki/NoSQL">NoSQL</a> storage options:</p>
<ul>
<li>[SimpleDB] (<a href="http://aws.amazon.com/simpledb/">http://aws.amazon.com/simpledb/</a>) - Amazon SimpleDB is a highly
available and flexible non-relational data store that offloads the work of
database administration. Developers simply store and query data items via web
services requests and Amazon SimpleDB does the rest.</li>
<li>[DynamoDB] (<a href="http://aws.amazon.com/dynamodb/">http://aws.amazon.com/dynamodb/</a>) - Amazon DynamoDB is a
fully-managed, high performance, NoSQL database service that is easy to set
up, operate, and scale.</li>
</ul>
<p><!-- more --></p>
<h2 id="amazon-s-review-of-big-data-solutions">Amazon&#39;s review of big data solutions</h2>
<p>Amazon&#39;s review <a href="http://aws.amazon.com/big-data/">Big Data on AWS</a> mentions
only DynamoDB and Elastic Map Reduce (based on Hadoop) as tools for big data
management.  As one of major DynamoDB benefits it is highlighted that it uses
solid state drives, but this option is also available for other technologies:</p>
<pre><code><div class="highlight"><pre><span class="nx">Solid</span> <span class="nx">state</span><span class="p">,</span> <span class="nx">at</span> <span class="nx">your</span> <span class="nx">service</span><span class="o">:</span>
<span class="nx">NoSQL</span> <span class="nx">data</span> <span class="nx">stores</span> <span class="nx">benefit</span> <span class="nx">greatly</span> <span class="nx">from</span> <span class="nx">the</span> <span class="nx">speed</span> <span class="nx">of</span> <span class="nx">solid</span> <span class="nx">state</span> <span class="nx">drives</span><span class="p">.</span>
<span class="nx">DynamoDB</span> <span class="nx">uses</span> <span class="nx">them</span> <span class="nx">by</span> <span class="k">default</span><span class="p">,</span> <span class="nx">but</span> <span class="k">if</span> <span class="nx">you</span> <span class="nx">are</span> <span class="nx">using</span> <span class="nx">alternatives</span> <span class="nx">from</span> <span class="nx">the</span> <span class="nx">AWS</span>
<span class="nx">Marketplace</span><span class="p">,</span> <span class="nx">such</span> <span class="nx">as</span> <span class="nx">Cassandra</span> <span class="nx">or</span> <span class="nx">MongoDB</span><span class="p">,</span> <span class="nx">accelerate</span> <span class="nx">your</span> <span class="nx">access</span> <span class="kd">with</span>
<span class="nx">on</span><span class="o">-</span><span class="nx">demand</span> <span class="nx">access</span> <span class="nx">to</span> <span class="nx">terabytes</span> <span class="nx">of</span> <span class="nx">solid</span> <span class="nx">state</span> <span class="nx">storage</span><span class="p">,</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">High</span> <span class="nx">I</span><span class="o">/</span><span class="nx">O</span>
<span class="nx">instance</span> <span class="kr">class</span><span class="p">.</span> <span class="nx">Learn</span> <span class="nx">more</span> <span class="nx">about</span> <span class="nx">the</span> <span class="nx">options</span> <span class="kd">with</span> <span class="nx">EC2</span> <span class="nx">instance</span> <span class="nx">types</span> <span class="p">(</span><span class="nx">http</span><span class="o">:</span><span class="c1">//aws.amazon.com/ec2/instance-types).</span>
</pre></div>

</code></pre><p>[Elastic Map Reduce] (<a href="http://aws.amazon.com/elasticmapreduce/">http://aws.amazon.com/elasticmapreduce/</a>) is a computing
service which can be used in conjunction with storage services to perform
operations on large datasets (indexing, data mining, log file analysis, etc).
Amazon Elastic MapReduce is a web service that enables businesses,
researchers, data analysts, and developers to easily and cost-effectively
process vast amounts of data.  Amazon Elastic Compute Cloud (EC2) - Amazon
Elastic Compute Cloud delivers scalable, pay-as-you-go compute capacity in
the cloud.</p>
<p>[Hadoop] (<a href="http://hadoop.apache.org/">http://hadoop.apache.org/</a>)
The Apache™ Hadoop® project develops open-source software for reliable,
scalable, distributed computing.  The Apache Hadoop software library is a
framework that allows for the distributed processing of large data sets across
clusters of computers using simple programming models. It is designed to scale
up from single servers to thousands of machines, each offering local
computation and storage. Rather than rely on hardware to deliver
high-availability, the library itself is designed to detect and handle failures
at the application layer, so delivering a highly-available service on top of a
cluster of computers, each of which may be prone to failures.</p>
<p>Q: When would I use Amazon RDS vs. Amazon EC2 Relational Database AMIs vs.
Amazon SimpleDB vs. Amazon DynamoDB? (<a href="http://aws.amazon.com/rds/faqs/#4">http://aws.amazon.com/rds/faqs/#4</a>)</p>
<pre><code><div class="highlight"><pre><span class="nx">Amazon</span> <span class="nx">Web</span> <span class="nx">Services</span> <span class="nx">provides</span> <span class="nx">a</span> <span class="nx">number</span> <span class="nx">of</span>
<span class="nx">database</span> <span class="nx">alternatives</span> <span class="k">for</span> <span class="nx">developers</span><span class="p">.</span> <span class="nx">Amazon</span> <span class="nx">RDS</span> <span class="nx">enables</span> <span class="nx">you</span> <span class="nx">to</span> <span class="nx">run</span> <span class="nx">a</span> <span class="nx">fully</span>
<span class="nx">featured</span> <span class="nx">relational</span> <span class="nx">database</span> <span class="k">while</span> <span class="nx">offloading</span> <span class="nx">database</span> <span class="nx">administration</span><span class="p">;</span> <span class="nx">Amazon</span>
<span class="nx">SimpleDB</span> <span class="nx">provides</span> <span class="nx">simple</span> <span class="nx">index</span> <span class="nx">and</span> <span class="nx">query</span> <span class="nx">capabilities</span> <span class="kd">with</span> <span class="nx">seamless</span>
<span class="nx">scalability</span><span class="p">;</span> <span class="nx">Amazon</span> <span class="nx">DynamoDB</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">fully</span> <span class="nx">managed</span> <span class="nx">NoSQL</span> <span class="nx">database</span> <span class="nx">service</span> <span class="nx">that</span>
<span class="nx">offers</span> <span class="nx">fast</span> <span class="nx">and</span> <span class="nx">predictable</span> <span class="nx">performance</span> <span class="kd">with</span> <span class="nx">seamless</span> <span class="nx">scalability</span><span class="p">;</span> <span class="nx">and</span> <span class="nx">using</span>
<span class="nx">one</span> <span class="nx">of</span> <span class="nx">our</span> <span class="nx">many</span> <span class="nx">relational</span> <span class="nx">database</span> <span class="nx">AMIs</span> <span class="nx">on</span> <span class="nx">Amazon</span> <span class="nx">EC2</span> <span class="nx">and</span> <span class="nx">Amazon</span> <span class="nx">EBS</span> <span class="nx">allows</span>
<span class="nx">you</span> <span class="nx">to</span> <span class="nx">operate</span> <span class="nx">your</span> <span class="nx">own</span> <span class="nx">relational</span> <span class="nx">database</span> <span class="k">in</span> <span class="nx">the</span> <span class="nx">cloud</span><span class="p">.</span> <span class="nx">There</span> <span class="nx">are</span> <span class="nx">important</span>
<span class="nx">differences</span> <span class="nx">between</span> <span class="nx">these</span> <span class="nx">alternatives</span> <span class="nx">that</span> <span class="nx">may</span> <span class="nx">make</span> <span class="nx">one</span> <span class="nx">more</span> <span class="nx">appropriate</span> <span class="k">for</span>
<span class="nx">your</span> <span class="nx">use</span> <span class="k">case</span><span class="p">.</span> <span class="nx">See</span> <span class="nx">Running</span> <span class="nx">Databases</span> <span class="nx">on</span> <span class="nx">AWS</span> <span class="k">for</span> <span class="nx">guidance</span> <span class="nx">on</span> <span class="nx">which</span> <span class="nx">solution</span> <span class="nx">is</span>
<span class="nx">best</span> <span class="k">for</span> <span class="nx">you</span><span class="p">.</span>
</pre></div>

</code></pre><h1 id="amazon-dynamodb">Amazon DynamoDB</h1>
<h2 id="general-info">General Info</h2>
<p><a href="http://docs.aws.amazon.com/amazondynamodb/latest/developerguide/GettingStartedDynamoDB.html">Get Started with Amazon DynamoDB</a>:</p>
<pre><code><div class="highlight"><pre><span class="nx">Amazon</span> <span class="nx">DynamoDB</span> <span class="nx">automatically</span> <span class="nx">spreads</span> <span class="nx">the</span> <span class="nx">data</span> <span class="nx">and</span> <span class="nx">traffic</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">table</span> <span class="nx">over</span> <span class="nx">a</span>
<span class="nx">sufficient</span> <span class="nx">number</span> <span class="nx">of</span> <span class="nx">servers</span> <span class="nx">to</span> <span class="nx">handle</span> <span class="nx">the</span> <span class="nx">request</span> <span class="nx">capacity</span> <span class="nx">specified</span> <span class="nx">by</span> <span class="nx">the</span>
<span class="nx">customer</span> <span class="nx">and</span> <span class="nx">the</span> <span class="nx">amount</span> <span class="nx">of</span> <span class="nx">data</span> <span class="nx">stored</span><span class="p">,</span> <span class="k">while</span> <span class="nx">maintaining</span> <span class="nx">consistent</span> <span class="nx">and</span> <span class="nx">fast</span>
<span class="nx">performance</span><span class="p">.</span> <span class="nx">All</span> <span class="nx">data</span> <span class="nx">items</span> <span class="nx">are</span> <span class="nx">stored</span> <span class="nx">on</span> <span class="nx">Solid</span> <span class="nx">State</span> <span class="nx">Disks</span> <span class="p">(</span><span class="nx">SSDs</span><span class="p">)</span> <span class="nx">and</span> <span class="nx">are</span>
<span class="nx">automatically</span> <span class="nx">replicated</span> <span class="nx">across</span> <span class="nx">multiple</span> <span class="nx">Availability</span> <span class="nx">Zones</span> <span class="k">in</span> <span class="nx">a</span> <span class="nx">Region</span> <span class="nx">to</span>
<span class="nx">provide</span> <span class="nx">built</span><span class="o">-</span><span class="k">in</span> <span class="nx">high</span> <span class="nx">availability</span> <span class="nx">and</span> <span class="nx">data</span> <span class="nx">durability</span><span class="p">.</span>
</pre></div>

</code></pre><p>Read / write throughput limits:</p>
<pre><code><div class="highlight"><pre><span class="nx">Provisioned</span> <span class="nx">Throughput</span> <span class="o">-</span> <span class="nx">When</span> <span class="nx">you</span> <span class="nx">create</span> <span class="nx">or</span> <span class="nx">update</span> <span class="nx">a</span> <span class="nx">table</span><span class="p">,</span> <span class="nx">you</span> <span class="nx">specify</span> <span class="nx">how</span>
<span class="nx">much</span> <span class="nx">provisioned</span> <span class="nx">throughput</span> <span class="nx">capacity</span> <span class="nx">you</span> <span class="nx">want</span> <span class="nx">to</span> <span class="nx">reserve</span> <span class="k">for</span> <span class="nx">reads</span> <span class="nx">and</span> <span class="nx">writes</span><span class="p">.</span>
<span class="nx">Amazon</span> <span class="nx">DynamoDB</span> <span class="nx">will</span> <span class="nx">reserve</span> <span class="nx">the</span> <span class="nx">necessary</span> <span class="nx">machine</span> <span class="nx">resources</span> <span class="nx">to</span> <span class="nx">meet</span> <span class="nx">your</span>
<span class="nx">throughput</span> <span class="nx">needs</span> <span class="k">while</span> <span class="nx">ensuring</span> <span class="nx">consistent</span><span class="p">,</span> <span class="nx">low</span><span class="o">-</span><span class="nx">latency</span> <span class="nx">performance</span><span class="p">.</span>  <span class="nx">If</span> <span class="nx">your</span>
<span class="nx">application</span> <span class="nx">requirements</span> <span class="nx">change</span><span class="p">,</span> <span class="nx">simply</span> <span class="nx">update</span> <span class="nx">your</span> <span class="nx">table</span> <span class="nx">throughput</span> <span class="nx">capacity</span>
<span class="nx">using</span> <span class="nx">the</span> <span class="nx">AWS</span> <span class="nx">Management</span> <span class="nx">Console</span> <span class="nx">or</span> <span class="nx">the</span> <span class="nx">Amazon</span> <span class="nx">DynamoDB</span> <span class="nx">APIs</span><span class="p">.</span> <span class="nx">You</span> <span class="nx">are</span> <span class="nx">still</span>
<span class="nx">able</span> <span class="nx">to</span> <span class="nx">achieve</span> <span class="nx">your</span> <span class="nx">prior</span> <span class="nx">throughput</span> <span class="nx">levels</span> <span class="k">while</span> <span class="nx">scaling</span> <span class="nx">is</span> <span class="nx">underway</span><span class="p">.</span>

<span class="nx">When</span> <span class="nx">you</span> <span class="nx">create</span> <span class="nx">a</span> <span class="nx">table</span><span class="p">,</span> <span class="nx">you</span> <span class="nx">must</span> <span class="nx">provide</span> <span class="nx">a</span> <span class="nx">table</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">its</span> <span class="nx">primary</span> <span class="nx">key</span> <span class="nx">and</span>
<span class="nx">your</span> <span class="nx">required</span> <span class="nx">read</span> <span class="nx">and</span> <span class="nx">write</span> <span class="nx">throughput</span> <span class="nx">values</span><span class="p">.</span> <span class="nx">Except</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">required</span> <span class="nx">primary</span>
<span class="nx">key</span><span class="p">,</span> <span class="nx">an</span> <span class="nx">Amazon</span> <span class="nx">DynamoDB</span> <span class="nx">table</span> <span class="nx">is</span> <span class="nx">schema</span><span class="o">-</span><span class="nx">less</span><span class="p">.</span> <span class="nx">Individual</span> <span class="nx">items</span> <span class="k">in</span> <span class="nx">an</span> <span class="nx">Amazon</span>
<span class="nx">DynamoDB</span> <span class="nx">table</span> <span class="nx">can</span> <span class="nx">have</span> <span class="nx">any</span> <span class="nx">number</span> <span class="nx">of</span> <span class="nx">attributes</span><span class="p">,</span> <span class="nx">although</span> <span class="nx">there</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">limit</span> <span class="nx">of</span>
<span class="mi">64</span> <span class="nx">KB</span> <span class="nx">on</span> <span class="nx">the</span> <span class="nx">item</span> <span class="nx">size</span><span class="p">.</span>  <span class="nx">A</span> <span class="nx">unit</span> <span class="nx">of</span> <span class="nx">read</span> <span class="nx">capacity</span> <span class="nx">represents</span> <span class="nx">one</span> <span class="nx">strongly</span>
<span class="nx">consistent</span> <span class="nx">read</span> <span class="nx">per</span> <span class="nx">second</span> <span class="p">(</span><span class="nx">or</span> <span class="nx">two</span> <span class="nx">eventually</span> <span class="nx">consistent</span> <span class="nx">reads</span> <span class="nx">per</span> <span class="nx">second</span><span class="p">)</span> <span class="k">for</span>
<span class="nx">items</span> <span class="nx">as</span> <span class="nx">large</span> <span class="nx">as</span> <span class="mi">4</span> <span class="nx">KB</span><span class="p">.</span> <span class="nx">A</span> <span class="nx">unit</span> <span class="nx">of</span> <span class="nx">write</span> <span class="nx">capacity</span> <span class="nx">represents</span> <span class="nx">one</span> <span class="nx">write</span> <span class="nx">per</span>
<span class="nx">second</span> <span class="k">for</span> <span class="nx">items</span> <span class="nx">as</span> <span class="nx">large</span> <span class="nx">as</span> <span class="mi">1</span> <span class="nx">KB</span><span class="p">.</span>  <span class="nx">Reads</span> <span class="o">=</span> <span class="nb">Number</span> <span class="nx">of</span> <span class="nx">item</span> <span class="nx">reads</span> <span class="nx">per</span> <span class="nx">second</span> <span class="err">×</span> <span class="mi">4</span>
<span class="nx">KB</span> <span class="nx">item</span> <span class="nx">size</span> <span class="p">(</span><span class="nx">If</span> <span class="nx">you</span> <span class="nx">use</span> <span class="nx">eventually</span> <span class="nx">consistent</span> <span class="nx">reads</span><span class="p">,</span> <span class="nx">you</span><span class="err">&#39;</span><span class="nx">ll</span> <span class="nx">get</span> <span class="nx">twice</span> <span class="nx">as</span> <span class="nx">many</span>
<span class="nx">reads</span> <span class="nx">per</span> <span class="nx">second</span><span class="p">.)</span> <span class="nx">Writes</span> <span class="o">=</span> <span class="nb">Number</span> <span class="nx">of</span> <span class="nx">item</span> <span class="nx">writes</span> <span class="nx">per</span> <span class="nx">second</span> <span class="err">×</span> <span class="mi">1</span> <span class="nx">KB</span> <span class="nx">item</span> <span class="nx">size</span><span class="p">.</span>
</pre></div>

</code></pre><p>Amazon DynamoDB supports the following two types of primary keys:</p>
<ul>
<li>Hash Primary Key – The primary key is made of one attribute, a hash
attribute. For example, a ProductCatalog table can have ProductID as its
primary key. Amazon DynamoDB builds an unordered hash index on this primary
key attribute.</li>
<li>Hash and Range Primary Key – The primary key is made of two attributes. The
first attribute is the hash attribute and the second attribute is the range
attribute. For example, the forum Thread table can have ForumName and Subject
as its primary key, where ForumName is the hash attribute and Subject is the
range attribute. Amazon DynamoDB builds an unordered hash index on the hash
attribute and a sorted range index on the range attribute.</li>
</ul>
<p>Local Secondary Indexes:</p>
<pre><code><div class="highlight"><pre><span class="nx">When</span> <span class="nx">you</span> <span class="nx">create</span> <span class="nx">a</span> <span class="nx">table</span> <span class="kd">with</span> <span class="nx">a</span> <span class="nx">hash</span><span class="o">-</span><span class="nx">and</span><span class="o">-</span><span class="nx">range</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">you</span>
<span class="nx">can</span> <span class="nx">optionally</span> <span class="nx">define</span> <span class="nx">one</span> <span class="nx">or</span> <span class="nx">more</span> <span class="nx">local</span> <span class="nx">secondary</span> <span class="nx">indexes</span> <span class="nx">on</span> <span class="nx">that</span> <span class="nx">table</span><span class="p">.</span> <span class="nx">A</span>
<span class="nx">local</span> <span class="nx">secondary</span> <span class="nx">index</span> <span class="nx">lets</span> <span class="nx">you</span> <span class="nx">query</span> <span class="nx">the</span> <span class="nx">data</span> <span class="k">in</span> <span class="nx">the</span> <span class="nx">table</span> <span class="nx">using</span> <span class="nx">an</span> <span class="nx">alternate</span>
<span class="nx">range</span> <span class="nx">key</span><span class="p">,</span> <span class="k">in</span> <span class="nx">addition</span> <span class="nx">to</span> <span class="nx">queries</span> <span class="nx">against</span> <span class="nx">the</span> <span class="nx">primary</span> <span class="nx">key</span><span class="p">.</span>
</pre></div>

</code></pre><p>Amazon DynamoDB Data Types Amazon DynamoDB supports the following data types:</p>
<ul>
<li>Scalar data types - Number, String, and Binary.</li>
<li>Multi-valued types - String Set, Number Set, and Binary Set.</li>
</ul>
<p>API / SDK:</p>
<pre><code><div class="highlight"><pre><span class="nx">Amazon</span> <span class="nx">DynamoDB</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">web</span> <span class="nx">service</span> <span class="nx">that</span> <span class="nx">uses</span> <span class="nx">HTTP</span> <span class="nx">and</span> <span class="nx">HTTPS</span> <span class="nx">as</span> <span class="nx">a</span> <span class="nx">transport</span> <span class="nx">and</span>
<span class="nx">JavaScript</span> <span class="nb">Object</span> <span class="nx">Notation</span> <span class="p">(</span><span class="nx">JSON</span><span class="p">)</span> <span class="nx">as</span> <span class="nx">a</span> <span class="nx">message</span> <span class="nx">serialization</span> <span class="nx">format</span><span class="p">.</span> <span class="nx">Your</span>
<span class="nx">application</span> <span class="nx">code</span> <span class="nx">can</span> <span class="nx">make</span> <span class="nx">requests</span> <span class="nx">directly</span> <span class="nx">to</span> <span class="nx">the</span> <span class="nx">Amazon</span> <span class="nx">DynamoDB</span> <span class="nx">web</span> <span class="nx">service</span>
</pre></div>

</code></pre><p>  API Reference
  (<a href="http://docs.aws.amazon.com/amazondynamodb/latest/APIReference/Welcome.html">http://docs.aws.amazon.com/amazondynamodb/latest/APIReference/Welcome.html</a>).
  There is also PHP library as a part of Amazon PHP SDK
  (<a href="https://github.com/aws/aws-sdk-php">https://github.com/aws/aws-sdk-php</a>).</p>
<h2 id="dynamodb-as-events-storage-and-limitations">DynamoDB as events storage and limitations</h2>
<p>For example, we have a table to store events data with following fields:</p>
<ul>
<li>id, primary key, integer</li>
<li>user_id, integer</li>
<li>event_type_id, integer</li>
<li>data, text</li>
<li>create_time, timestamp</li>
</ul>
<p>And we have large amount of events for which we need to perform following operations:</p>
<ul>
<li>filter by date</li>
<li>filter by user</li>
<li>filter by event type</li>
<li>filter by data</li>
<li>sorting</li>
<li>pagination</li>
<li>export</li>
</ul>
<p>DynamoDB limitations:</p>
<ul>
<li>For &#39;data&#39; filed we can store up to 64KB (DynamoDB limitation). If we need
to store more data then we need to use compression.</li>
<li>Filters require additional indexes (not recommended to add many indexes, also
indexes consume write limits and add a data size limitation).</li>
<li>Filter by &#39;data&#39; filed - can be not possible if we will compress data (or we may need to maintain own index)</li>
<li>Sorting - no, query results are always sorted by the range key</li>
<li>Pagination - yes (using Limit, LastEvaluatedKey, and ExclusiveStartKey), but
single request can not return more then 1MB, so if page contains more data
then less items will be returned.</li>
<li>Export - no (we can not get more then 1MB via single request)</li>
</ul>
<p>Additional indexes to perform data filtering (see
<a href="http://docs.aws.amazon.com/amazondynamodb/latest/developerguide/GuidelinesForLSI.html">http://docs.aws.amazon.com/amazondynamodb/latest/developerguide/GuidelinesForLSI.html</a> ):
having many indexes is not recommended because they consume storage and
provisioned throughput and make table operations slower.</p>
<p>For tables with local secondary indexes there is size limit of 10GB for data
with the same hash key
(<a href="http://docs.aws.amazon.com/amazondynamodb/latest/developerguide/LSI.html">http://docs.aws.amazon.com/amazondynamodb/latest/developerguide/LSI.html</a>).</p>
<pre><code><div class="highlight"><pre><span class="nx">The</span> <span class="nx">maximum</span> <span class="nx">size</span> <span class="nx">of</span> <span class="nx">any</span> <span class="nx">item</span> <span class="nx">collection</span> <span class="nx">is</span> <span class="mi">10</span> <span class="nx">GB</span><span class="p">.</span> <span class="nx">This</span> <span class="nx">limit</span> <span class="nx">does</span> <span class="nx">not</span> <span class="nx">apply</span> <span class="nx">to</span>
<span class="nx">tables</span> <span class="nx">without</span> <span class="nx">local</span> <span class="nx">secondary</span> <span class="nx">indexes</span><span class="p">;</span> <span class="nx">only</span> <span class="nx">tables</span> <span class="nx">that</span> <span class="nx">have</span> <span class="nx">one</span> <span class="nx">or</span> <span class="nx">more</span> <span class="nx">local</span>
<span class="nx">secondary</span> <span class="nx">indexes</span> <span class="nx">are</span> <span class="nx">affected</span><span class="p">.</span>
<span class="nx">We</span> <span class="nx">recommend</span> <span class="nx">as</span> <span class="nx">a</span> <span class="nx">best</span> <span class="nx">practice</span> <span class="nx">that</span> <span class="nx">you</span> <span class="nx">instrument</span> <span class="nx">your</span> <span class="nx">application</span> <span class="nx">to</span> <span class="nx">monitor</span>
<span class="nx">the</span> <span class="nx">sizes</span> <span class="nx">of</span> <span class="nx">your</span> <span class="nx">item</span> <span class="nx">collections</span><span class="p">.</span> <span class="nx">One</span> <span class="nx">way</span> <span class="nx">to</span> <span class="k">do</span> <span class="nx">so</span> <span class="nx">is</span> <span class="nx">to</span> <span class="nx">set</span> <span class="nx">the</span>
<span class="nx">ReturnItemCollectionMetrics</span> <span class="nx">parameter</span> <span class="nx">to</span> <span class="nx">SIZE</span> <span class="nx">whenever</span> <span class="nx">you</span> <span class="nx">use</span> <span class="nx">BatchWriteItem</span><span class="p">,</span>
<span class="nx">DeleteItem</span><span class="p">,</span> <span class="nx">PutItem</span> <span class="nx">or</span> <span class="nx">UpdateItem</span><span class="p">.</span> <span class="nx">Your</span> <span class="nx">application</span> <span class="nx">should</span> <span class="nx">examine</span> <span class="nx">the</span>
<span class="nx">ReturnItemCollectionMetrics</span> <span class="nx">object</span> <span class="k">in</span> <span class="nx">the</span> <span class="nx">output</span> <span class="nx">and</span> <span class="nx">log</span> <span class="nx">an</span> <span class="nx">error</span> <span class="nx">message</span>
<span class="nx">whenever</span> <span class="nx">an</span> <span class="nx">item</span> <span class="nx">collection</span> <span class="nx">exceeds</span> <span class="nx">a</span> <span class="nx">user</span><span class="o">-</span><span class="nx">defined</span> <span class="nx">limit</span> <span class="p">(</span><span class="mi">8</span> <span class="nx">GB</span><span class="p">,</span> <span class="k">for</span> <span class="nx">example</span><span class="p">).</span>
<span class="nx">Setting</span> <span class="nx">a</span> <span class="nx">limit</span> <span class="nx">that</span> <span class="nx">is</span> <span class="nx">less</span> <span class="nx">than</span> <span class="mi">10</span> <span class="nx">GB</span> <span class="nx">would</span> <span class="nx">provide</span> <span class="nx">an</span> <span class="nx">early</span> <span class="nx">warning</span> <span class="nx">system</span>
<span class="nx">so</span> <span class="nx">you</span> <span class="nx">know</span> <span class="nx">that</span> <span class="nx">an</span> <span class="nx">item</span> <span class="nx">collection</span> <span class="nx">is</span> <span class="nx">approaching</span> <span class="nx">the</span> <span class="nx">limit</span> <span class="k">in</span> <span class="nx">time</span> <span class="nx">to</span> <span class="k">do</span>
<span class="nx">something</span> <span class="nx">about</span> <span class="nx">it</span><span class="p">.</span>

<span class="nx">Item</span> <span class="nx">collection</span> <span class="o">-</span> <span class="nx">is</span> <span class="nx">any</span> <span class="nx">group</span> <span class="nx">of</span> <span class="nx">items</span> <span class="nx">that</span> <span class="nx">have</span> <span class="nx">the</span> <span class="nx">same</span> <span class="nx">hash</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">across</span> <span class="nx">a</span>
<span class="nx">table</span> <span class="nx">and</span> <span class="nx">all</span> <span class="nx">of</span> <span class="nx">its</span> <span class="nx">local</span> <span class="nx">secondary</span> <span class="nx">indexes</span><span class="p">.</span> <span class="nx">For</span> <span class="nx">instance</span><span class="p">,</span> <span class="nx">consider</span> <span class="nx">an</span>
<span class="nx">e</span><span class="o">-</span><span class="nx">commerce</span> <span class="nx">application</span> <span class="nx">that</span> <span class="nx">stores</span> <span class="nx">customer</span> <span class="nx">order</span> <span class="nx">data</span> <span class="k">in</span> <span class="nx">a</span> <span class="nx">DynamoDB</span> <span class="nx">table</span> <span class="kd">with</span>
<span class="nx">hash</span><span class="o">-</span><span class="nx">range</span> <span class="nx">schema</span> <span class="nx">of</span> <span class="nx">customer</span> <span class="nx">id</span><span class="o">-</span><span class="nx">order</span> <span class="nx">timestamp</span><span class="p">.</span> <span class="nx">Without</span> <span class="nx">LSI</span><span class="p">,</span> <span class="nx">to</span> <span class="nx">find</span> <span class="nx">an</span>
<span class="nx">answer</span> <span class="nx">to</span> <span class="nx">the</span> <span class="nx">question</span> <span class="err">“</span><span class="nx">Display</span> <span class="nx">all</span> <span class="nx">orders</span> <span class="nx">made</span> <span class="nx">by</span> <span class="nx">Customer</span> <span class="nx">X</span> <span class="kd">with</span> <span class="nx">shipping</span>
<span class="nx">date</span> <span class="k">in</span> <span class="nx">the</span> <span class="nx">past</span> <span class="mi">30</span> <span class="nx">days</span><span class="p">,</span> <span class="nx">sorted</span> <span class="nx">by</span> <span class="nx">shipping</span> <span class="nx">date</span><span class="err">”</span><span class="p">,</span> <span class="nx">you</span> <span class="nx">had</span> <span class="nx">to</span> <span class="nx">use</span> <span class="nx">the</span> <span class="nx">Query</span>
<span class="nx">API</span> <span class="nx">to</span> <span class="nx">retrieve</span> <span class="nx">all</span> <span class="nx">the</span> <span class="nx">objects</span> <span class="nx">under</span> <span class="nx">the</span> <span class="nx">hash</span> <span class="nx">key</span> <span class="err">“</span><span class="nx">X</span><span class="err">”</span><span class="p">,</span> <span class="nx">sort</span> <span class="nx">the</span> <span class="nx">results</span> <span class="nx">by</span>
<span class="nx">shipment</span> <span class="nx">date</span> <span class="nx">and</span> <span class="nx">then</span> <span class="nx">filter</span> <span class="nx">out</span> <span class="nx">older</span> <span class="nx">records</span><span class="p">.</span>
</pre></div>

</code></pre><p>It is not possible to add secondary indexes into existing table.</p>
<p>Existing indexes also can not be changed or deleted.</p>
<p>Query results sorting:</p>
<pre><code><div class="highlight"><pre><span class="nx">Query</span> <span class="nx">results</span> <span class="nx">are</span> <span class="nx">always</span> <span class="nx">sorted</span> <span class="nx">by</span> <span class="nx">the</span> <span class="nx">range</span> <span class="nx">key</span><span class="p">.</span> <span class="nx">If</span> <span class="nx">the</span> <span class="nx">data</span> <span class="nx">type</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">range</span>
<span class="nx">key</span> <span class="nx">is</span> <span class="nb">Number</span><span class="p">,</span> <span class="nx">the</span> <span class="nx">results</span> <span class="nx">are</span> <span class="nx">returned</span> <span class="k">in</span> <span class="nx">numeric</span> <span class="nx">order</span><span class="p">;</span> <span class="nx">otherwise</span><span class="p">,</span> <span class="nx">the</span>
<span class="nx">results</span> <span class="nx">are</span> <span class="nx">returned</span> <span class="k">in</span> <span class="nx">order</span> <span class="nx">of</span> <span class="nx">ASCII</span> <span class="nx">character</span> <span class="nx">code</span> <span class="nx">values</span><span class="p">.</span> <span class="nx">By</span> <span class="k">default</span><span class="p">,</span> <span class="nx">the</span>
<span class="nx">sort</span> <span class="nx">order</span> <span class="nx">is</span> <span class="nx">ascending</span><span class="p">.</span> <span class="nx">To</span> <span class="nx">reverse</span> <span class="nx">the</span> <span class="nx">order</span> <span class="nx">use</span> <span class="nx">the</span> <span class="nx">ScanIndexForward</span>
<span class="nx">parameter</span> <span class="nx">set</span> <span class="nx">to</span> <span class="kc">false</span><span class="p">.</span>
</pre></div>

</code></pre><p>Get records count:</p>
<pre><code><div class="highlight"><pre><span class="k">in</span> <span class="nx">a</span> <span class="nx">request</span><span class="p">,</span> <span class="nx">set</span> <span class="nx">the</span> <span class="nx">Count</span> <span class="nx">parameter</span> <span class="nx">to</span> <span class="kc">true</span> <span class="k">if</span> <span class="nx">you</span> <span class="nx">want</span>
<span class="nx">Amazon</span> <span class="nx">DynamoDB</span> <span class="nx">to</span> <span class="nx">provide</span> <span class="nx">the</span> <span class="nx">total</span> <span class="nx">number</span> <span class="nx">of</span> <span class="nx">items</span> <span class="nx">that</span> <span class="nx">match</span> <span class="nx">the</span> <span class="nx">scan</span> <span class="nx">filter</span>
<span class="nx">or</span> <span class="nx">query</span> <span class="nx">condition</span><span class="p">,</span> <span class="nx">instead</span> <span class="nx">of</span> <span class="nx">a</span> <span class="nx">list</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">matching</span> <span class="nx">items</span><span class="p">.</span> <span class="nx">In</span> <span class="nx">a</span> <span class="nx">response</span><span class="p">,</span>
<span class="nx">Amazon</span> <span class="nx">DynamoDB</span> <span class="nx">returns</span> <span class="nx">a</span> <span class="nx">Count</span> <span class="nx">value</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">number</span> <span class="nx">of</span> <span class="nx">matching</span> <span class="nx">items</span> <span class="k">in</span> <span class="nx">a</span>
<span class="nx">request</span><span class="p">.</span> <span class="nx">If</span> <span class="nx">the</span> <span class="nx">matching</span> <span class="nx">items</span> <span class="k">for</span> <span class="nx">a</span> <span class="nx">scan</span> <span class="nx">filter</span> <span class="nx">or</span> <span class="nx">query</span> <span class="nx">condition</span> <span class="nx">is</span> <span class="nx">over</span> <span class="mi">1</span>
<span class="nx">MB</span><span class="p">,</span> <span class="nx">Count</span> <span class="nx">contains</span> <span class="nx">a</span> <span class="nx">partial</span> <span class="nx">count</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">total</span> <span class="nx">number</span> <span class="nx">of</span> <span class="nx">items</span> <span class="nx">that</span> <span class="nx">match</span> <span class="nx">the</span>
<span class="nx">request</span><span class="p">.</span> <span class="nx">To</span> <span class="nx">get</span> <span class="nx">the</span> <span class="nx">full</span> <span class="nx">count</span> <span class="nx">of</span> <span class="nx">items</span> <span class="nx">that</span> <span class="nx">match</span> <span class="nx">a</span> <span class="nx">request</span><span class="p">,</span> <span class="nx">use</span> <span class="nx">the</span>
<span class="nx">LastEvaluatedKey</span> <span class="k">in</span> <span class="nx">a</span> <span class="nx">subsequent</span> <span class="nx">request</span><span class="p">.</span> <span class="nx">Repeat</span> <span class="nx">the</span> <span class="nx">request</span> <span class="nx">until</span> <span class="nx">Amazon</span>
<span class="nx">DynamoDB</span> <span class="nx">no</span> <span class="nx">longer</span> <span class="nx">returns</span> <span class="nx">a</span> <span class="nx">LastEvaluatedKey</span><span class="p">.</span>
</pre></div>

</code></pre><p>Single operation size limit:</p>
<pre><code><div class="highlight"><pre><span class="nx">A</span> <span class="nx">single</span> <span class="nx">operation</span> <span class="nx">can</span> <span class="nx">retrieve</span> <span class="nx">up</span> <span class="nx">to</span> <span class="mi">1</span> <span class="nx">MB</span> <span class="nx">of</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">which</span> <span class="nx">can</span> <span class="nx">comprise</span>
<span class="nx">as</span> <span class="nx">many</span> <span class="nx">as</span> <span class="mi">100</span> <span class="nx">items</span><span class="p">.</span> <span class="nx">BatchGetItem</span> <span class="nx">will</span> <span class="k">return</span> <span class="nx">a</span> <span class="nx">partial</span> <span class="nx">result</span> <span class="k">if</span> <span class="nx">the</span> <span class="nx">response</span>
<span class="nx">size</span> <span class="nx">limit</span> <span class="nx">is</span> <span class="nx">exceeded</span><span class="p">,</span> <span class="nx">the</span> <span class="nx">table</span><span class="err">&#39;</span><span class="nx">s</span> <span class="nx">provisioned</span> <span class="nx">throughput</span> <span class="nx">is</span> <span class="nx">exceeded</span><span class="p">,</span> <span class="nx">or</span> <span class="nx">an</span>
<span class="nx">internal</span> <span class="nx">processing</span> <span class="nx">failure</span> <span class="nx">occurs</span><span class="p">.</span> <span class="nx">If</span> <span class="nx">a</span> <span class="nx">partial</span> <span class="nx">result</span> <span class="nx">is</span> <span class="nx">returned</span><span class="p">,</span> <span class="nx">the</span>
<span class="nx">operation</span> <span class="nx">returns</span> <span class="nx">a</span> <span class="nx">value</span> <span class="k">for</span> <span class="nx">UnprocessedKeys</span><span class="p">.</span> <span class="nx">You</span> <span class="nx">can</span> <span class="nx">use</span> <span class="k">this</span> <span class="nx">value</span> <span class="nx">to</span> <span class="nx">retry</span>
<span class="nx">the</span> <span class="nx">operation</span> <span class="nx">starting</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">next</span> <span class="nx">item</span> <span class="nx">to</span> <span class="nx">get</span><span class="p">.</span>  <span class="nx">For</span> <span class="nx">example</span><span class="p">,</span> <span class="k">if</span> <span class="nx">you</span> <span class="nx">ask</span> <span class="nx">to</span>
<span class="nx">retrieve</span> <span class="mi">100</span> <span class="nx">items</span><span class="p">,</span> <span class="nx">but</span> <span class="nx">each</span> <span class="nx">individual</span> <span class="nx">item</span> <span class="nx">is</span> <span class="mi">50</span> <span class="nx">KB</span> <span class="k">in</span> <span class="nx">size</span><span class="p">,</span> <span class="nx">the</span> <span class="nx">system</span>
<span class="nx">returns</span> <span class="mi">20</span> <span class="nx">items</span> <span class="p">(</span><span class="mi">1</span> <span class="nx">MB</span><span class="p">)</span> <span class="nx">and</span> <span class="nx">an</span> <span class="nx">appropriate</span> <span class="nx">UnprocessedKeys</span> <span class="nx">value</span> <span class="nx">so</span> <span class="nx">you</span> <span class="nx">can</span> <span class="nx">get</span>
<span class="nx">the</span> <span class="nx">next</span> <span class="nx">page</span> <span class="nx">of</span> <span class="nx">results</span><span class="p">.</span> <span class="nx">If</span> <span class="nx">desired</span><span class="p">,</span> <span class="nx">your</span> <span class="nx">application</span> <span class="nx">can</span> <span class="nx">include</span> <span class="nx">its</span> <span class="nx">own</span>
<span class="nx">logic</span> <span class="nx">to</span> <span class="nx">assemble</span> <span class="nx">the</span> <span class="nx">pages</span> <span class="nx">of</span> <span class="nx">results</span> <span class="nx">into</span> <span class="nx">one</span> <span class="nx">dataset</span><span class="p">.</span>
</pre></div>

</code></pre><p>Export - data export can be implemented as off-line operation using Elastic Map
Reduce. See <a href="http://docs.aws.amazon.com/amazondynamodb/latest/developerguide/EMRforDynamoDB.html">Elastic Map Reduce use cases</a>:</p>
<ul>
<li>Exporting data stored in Amazon DynamoDB to Amazon S3.</li>
<li>Importing data in Amazon S3 to Amazon DynamoDB.</li>
<li>Querying live Amazon DynamoDB data using SQL-like statements (HiveQL).</li>
<li>Joining data stored in Amazon DynamoDB and exporting it or querying against the joined data.</li>
<li>Loading Amazon DynamoDB data into the Hadoop Distributed File System (HDFS) and using it as input into an Amazon EMR job flow.</li>
</ul>
<p>To perform advanced queries on data it is also possible to <a href="http://docs.aws.amazon.com/amazondynamodb/latest/developerguide/RedshiftforDynamoDB.html">copy data to Amazon Redshift</a>:</p>
<pre><code><div class="highlight"><pre><span class="nx">Amazon</span> <span class="nx">Redshift</span> <span class="nx">complements</span> <span class="nx">Amazon</span> <span class="nx">DynamoDB</span> <span class="kd">with</span> <span class="nx">advanced</span> <span class="nx">business</span> <span class="nx">intelligence</span>
<span class="nx">capabilities</span> <span class="nx">and</span> <span class="nx">a</span> <span class="nx">powerful</span> <span class="nx">SQL</span><span class="o">-</span><span class="nx">based</span> <span class="kr">interface</span><span class="p">.</span> <span class="nx">When</span> <span class="nx">you</span> <span class="nx">copy</span> <span class="nx">data</span> <span class="nx">from</span> <span class="nx">an</span>
<span class="nx">Amazon</span> <span class="nx">DynamoDB</span> <span class="nx">table</span> <span class="nx">into</span> <span class="nx">Amazon</span> <span class="nx">Redshift</span><span class="p">,</span> <span class="nx">you</span> <span class="nx">can</span> <span class="nx">perform</span> <span class="nx">complex</span> <span class="nx">data</span>
<span class="nx">analysis</span> <span class="nx">queries</span> <span class="nx">on</span> <span class="nx">that</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">including</span> <span class="nx">joins</span> <span class="kd">with</span> <span class="nx">other</span> <span class="nx">tables</span> <span class="k">in</span> <span class="nx">your</span> <span class="nx">Amazon</span>
<span class="nx">Redshift</span> <span class="nx">cluster</span><span class="p">.</span>
<span class="nx">In</span> <span class="nx">terms</span> <span class="nx">of</span> <span class="nx">provisioned</span> <span class="nx">throughput</span><span class="p">,</span> <span class="nx">a</span> <span class="nx">copy</span> <span class="nx">operation</span> <span class="nx">from</span> <span class="nx">an</span> <span class="nx">Amazon</span> <span class="nx">DynamoDB</span>
<span class="nx">table</span> <span class="nx">counts</span> <span class="nx">against</span> <span class="nx">that</span> <span class="nx">table</span><span class="err">&#39;</span><span class="nx">s</span> <span class="nx">read</span> <span class="nx">capacity</span><span class="p">.</span> <span class="nx">After</span> <span class="nx">the</span> <span class="nx">data</span> <span class="nx">is</span> <span class="nx">copied</span><span class="p">,</span> <span class="nx">your</span>
<span class="nx">SQL</span> <span class="nx">queries</span> <span class="k">in</span> <span class="nx">Amazon</span> <span class="nx">Redshift</span> <span class="k">do</span> <span class="nx">not</span> <span class="nx">affect</span> <span class="nx">Amazon</span> <span class="nx">DynamoDB</span> <span class="k">in</span> <span class="nx">any</span> <span class="nx">way</span><span class="p">.</span> <span class="nx">This</span>
<span class="nx">is</span> <span class="nx">because</span> <span class="nx">your</span> <span class="nx">queries</span> <span class="nx">act</span> <span class="nx">upon</span> <span class="nx">a</span> <span class="nx">copy</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">data</span> <span class="nx">from</span> <span class="nx">DynamoDB</span><span class="p">,</span> <span class="nx">rather</span> <span class="nx">than</span>
<span class="nx">upon</span> <span class="nx">DynamoDB</span> <span class="nx">itself</span><span class="p">.</span>
</pre></div>

</code></pre><h2 id="cost">Cost</h2>
<p>Dynamo db <a href="http://aws.amazon.com/dynamodb/pricing/">pricing page</a> and <a href="http://calculator.s3.amazonaws.com/calc5.html#s=DYNAMODB">price calculator</a>.</p>
<p>Assumptions (having events table described above):</p>
<ul>
<li>for each user (user_id in events table) we add 1 million records per day (24 hours)</li>
<li>each logged event data size is about 256 Bytes</li>
<li>DynamoDB table does not have local secondary indexes</li>
</ul>
<p>Parameters for cost calculation:</p>
<ul>
<li>Number of events logged per day (24 hours): 1 million records</li>
<li>Number of write requests (events logged per second): 12427 (for simplicity assume app launches are uniformly distributed across 24 hours)</li>
<li>Number or read requests: for simplicity assume we have no read requests (read requests are much cheaper then write requests)</li>
<li>Data size added per month: 30 million record * 0.25KB ~= 7GB</li>
</ul>
<p>Cost (according to the price calculator) is about $6500 per month (for a single user&#39;s data).</p>
<p>Notes:</p>
<ul>
<li>Reads are much cheaper then writes, so if we add the same number or reads into calculation it will not grow much.</li>
<li>We pay not for actual load, but for reserved load. So if we set writes per
second to 12000 then we will pay for this even if actual load will be low.
Limits can be changed to higher value at any time, but can be lowered only 4
times per day.</li>
</ul>
<h2 id="other-dynamodb-resources">Other DynamoDB resources</h2>
<p><a href="http://readwrite.com/2007/10/30/amazon_dynamo">Amazon Dynamo: The Next Generation Of Virtual Distributed Storage</a></p>
<p><a href="http://www.allthingsdistributed.com/2012/01/amazon-dynamodb.html">Amazon DynamoDB – a Fast and Scalable NoSQL Database Service Designed for Internet Scale Applications</a></p>
<p>[Why My Team Went with DynamoDB Over MongoDB] (<a href="http://slashdot.org/topic/bi/why-my-team-went-with-dynamodb-over-mongodb/">http://slashdot.org/topic/bi/why-my-team-went-with-dynamodb-over-mongodb/</a>) - limitations and possible solutions;
custom index (maybe at that time secondary indexes where not present); data as json + compression (other way is to store data as file to S3).</p>
<p><a href="https://www.dailycred.com/blog/10/dynamodb-shortcomings-and-our-work-arounds">DynamoDB shortcomings (and our work arounds)</a> they decided not to use DynamoDB for events (SQL was a better tool in this
case, so we decided not to use DynamoDB at all for storing events) and build cache between DynamoDB and their app.</p>
<p><a href="http://simondlr.com/post/26360955465/dynamodb-is-awesome-but">DYNAMODB IS AWESOME, BUT…</a> - about limitations.</p>
<p><a href="http://blog.coredumped.org/2012/01/amazon-dynamodb.html">Amazon DynamoDB</a> - about provisioned throughput, Query, Scan and indexing.</p>
<p><a href="http://www.allthingsdistributed.com/2013/04/dynamdb-local-seconda.ry-indices.html">Expanding the Cloud: Faster, More Flexible Queries with DynamoDB</a> - about secondary indexes</p>
<p>[My Disappointments with Amazon DynamoDB] (<a href="http://whynosql.com/my-disappointments-with-amazon-dynamodb/">http://whynosql.com/my-disappointments-with-amazon-dynamodb/</a>)</p>
<p>[Amazon DynamoDB Part III: MapReducin’ Logs] (<a href="http://www.newvem.com/amazon-dynamodb-part-iii-mapreducin-logs/">http://www.newvem.com/amazon-dynamodb-part-iii-mapreducin-logs/</a>)</p>
<p>Amazon forum threads:</p>
<ul>
<li><a href="https://forums.aws.amazon.com/message.jspa?messageID=333470">data import/export</a></li>
<li><a href="https://forums.aws.amazon.com/thread.jspa?messageID=454521">DynamoDB Use case</a></li>
<li><a href="https://forums.aws.amazon.com/thread.jspa?messageID=449080">DynamoDB Table Design</a></li>
<li><a href="https://forums.aws.amazon.com/thread.jspa?messageID=449927">Can i build a leaderboard with local secondary index?</a></li>
<li><a href="https://forums.aws.amazon.com/message.jspa?messageID=361520">DynamoDB Hash key partition strategy</a></li>
<li><a href="https://forums.aws.amazon.com/thread.jspa?messageID=312101">Partition size / key range info</a></li>
</ul>
<p>DynamoDB mocks:</p>
<ul>
<li><a href="https://forums.aws.amazon.com/message.jspa?messageID=329773">Forum thread: DynamoDB Mock</a></li>
<li><a href="https://github.com/perrystreetsoftware/clientside_aws">clientside_aws</a></li>
<li><a href="https://github.com/ananthakumaran/fake_dynamo">FakeDynamo</a></li>
<li><a href="https://github.com/mboudreau/Alternator">Alternator - A DynamoDB Mock Server</a></li>
</ul>
<h1 id="amazon-simpledb">Amazon SimpleDB</h1>
<h2 id="general-info">General Info</h2>
<p><a href="http://aws.amazon.com/simpledb/">Simple DB description page</a>.</p>
<p><a href="http://docs.aws.amazon.com/AmazonSimpleDB/2009-04-15/DeveloperGuide/Welcome.html">Developer Guide</a>.</p>
<p><a href="https://github.com/aws/aws-sdk-php">PHP SDK</a> and <a href="http://docs.aws.amazon.com/AmazonSimpleDB/2009-04-15/DeveloperGuide/SDB_API.html">HTTP API</a>.</p>
<h2 id="features">Features</h2>
<p><a href="http://docs.aws.amazon.com/AmazonSimpleDB/latest/DeveloperGuide/UsingSelect.html">Complex Queries</a></p>
<pre><code><div class="highlight"><pre><span class="nx">One</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">main</span> <span class="nx">uses</span> <span class="k">for</span> <span class="nx">Amazon</span> <span class="nx">SimpleDB</span> <span class="nx">involves</span> <span class="nx">making</span> <span class="nx">complex</span> <span class="nx">queries</span>
<span class="nx">against</span> <span class="nx">your</span> <span class="nx">data</span> <span class="nx">set</span><span class="p">,</span> <span class="nx">so</span> <span class="nx">you</span> <span class="nx">can</span> <span class="nx">get</span> <span class="nx">exactly</span> <span class="nx">the</span> <span class="nx">data</span> <span class="nx">you</span> <span class="nx">need</span><span class="p">.</span> <span class="nx">For</span> <span class="nx">more</span>
<span class="nx">information</span><span class="p">,</span> <span class="nx">refer</span> <span class="nx">to</span> <span class="nx">the</span> <span class="nx">Select</span> <span class="nx">section</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">Amazon</span> <span class="nx">SimpleDB</span> <span class="nx">Developer</span>
<span class="nx">Guide</span><span class="p">.</span>
</pre></div>

</code></pre><p>Select operator supports:</p>
<ul>
<li>where (comparison operators, including like), sort and limit.</li>
<li>count() (but query should be no longer then 5 seconds otherwise you will get partial result and need to repeat count() operation)</li>
<li>max / min values can be selected using ordering by value and limit 1.</li>
</ul>
<p>Data Storage and Performance</p>
<pre><code><div class="highlight"><pre><span class="nx">For</span> <span class="nx">information</span> <span class="nx">on</span> <span class="nx">how</span> <span class="nx">quickly</span> <span class="nx">stored</span> <span class="nx">data</span> <span class="nx">is</span> <span class="nx">recorded</span> <span class="nx">to</span> <span class="nx">Amazon</span> <span class="nx">SimpleDB</span><span class="p">,</span>
<span class="nx">refer</span> <span class="nx">to</span> <span class="nx">the</span> <span class="nx">Consistency</span> <span class="nx">section</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">Amazon</span> <span class="nx">SimpleDB</span> <span class="nx">Developer</span> <span class="nx">Guide</span><span class="p">.</span>
</pre></div>

</code></pre><p><a href="http://docs.aws.amazon.com/AmazonSimpleDB/latest/DeveloperGuide/SDBLimits.html">Limits and Restrictions</a></p>
<pre><code><div class="highlight"><pre><span class="nx">During</span> <span class="nx">development</span><span class="p">,</span> <span class="nx">it</span> <span class="nx">is</span> <span class="nx">important</span> <span class="nx">to</span> <span class="nx">understand</span> <span class="nx">Amazon</span> <span class="nx">SimpleDB</span><span class="err">&#39;</span><span class="nx">s</span> <span class="nx">limits</span>
<span class="nx">when</span> <span class="nx">storing</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">the</span> <span class="nx">amount</span> <span class="nx">of</span> <span class="nx">data</span> <span class="nx">Amazon</span> <span class="nx">SimpleDB</span> <span class="nx">can</span> <span class="k">return</span> <span class="nx">from</span> <span class="nx">a</span>
<span class="nx">query</span><span class="p">,</span> <span class="nx">and</span> <span class="nx">what</span> <span class="nx">to</span> <span class="k">do</span> <span class="k">if</span> <span class="nx">the</span> <span class="nx">limits</span> <span class="nx">are</span> <span class="nx">exceeded</span><span class="p">.</span> <span class="nx">For</span> <span class="nx">more</span> <span class="nx">information</span><span class="p">,</span> <span class="nx">refer</span>
<span class="nx">to</span> <span class="nx">the</span> <span class="nx">Limits</span> <span class="nx">section</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">Amazon</span> <span class="nx">SimpleDB</span> <span class="nx">Developer</span> <span class="nx">Guide</span><span class="p">.</span>
</pre></div>

</code></pre><p>Limits:</p>
<ul>
<li>Currently, you can store up to 10 GB per domain and you can create up to 250 domains.</li>
<li>Maximum 1 billion attributes per domain (probably this is summary number of attributes for all items).</li>
<li>Attribute value length - 1024 bytes.</li>
<li>Maximum items in select response - 2500.</li>
<li>Maximum query execution time - 5 seconds.</li>
<li>Maximum response size for Select - 1MB.</li>
<li><p>Requests per second (did not found in SimpleDB docs, but it is in the DynamoDB FAQ) - 25 writes per second (per domain?)</p>
<p>Designed for use with other Amazon Web Services—Amazon SimpleDB is designed to integrate easily with other web-scale services such as Amazon EC2 and Amazon S3.
For example, developers can run their applications in Amazon EC2 and store their data objects in Amazon S3. Amazon SimpleDB can then be used to query the object metadata from within the application in Amazon EC2 and return pointers to the objects stored in Amazon S3.</p>
</li>
</ul>
<p><a href="http://docs.aws.amazon.com/AmazonSimpleDB/latest/DeveloperGuide/DataSetPartitioningConcepts.html">Partition data to domains strategy</a>.</p>
<h2 id="simpledb-as-events-storage-and-limitations">SimpleDB as events storage and limitations</h2>
<p>A table to store events data has following fields:</p>
<ul>
<li>id, primary key, integer</li>
<li>user_id, integer</li>
<li>event_type_id, integer</li>
<li>data, text</li>
<li>create_time, timestamp</li>
</ul>
<p>There is large amount of data and we want to perform following operations:</p>
<ul>
<li>filter by date</li>
<li>filter by user</li>
<li>filter by event type</li>
<li>filter by data</li>
<li>sorting</li>
<li>pagination</li>
<li>export</li>
</ul>
<p>Limitations:</p>
<ul>
<li>Now data size is not limited (text field) and it will be limited (total item size has a limit of 1KB).</li>
<li>Filters - select operation allows us to implement all filters</li>
<li>Sorting - select operation allows us to sort data</li>
<li>Pagination - yes, but single request can not return more then 1MB, so if page contains more data
then less items will be returned.</li>
<li>Export - no (we can not get more then 1MB via single request)</li>
</ul>
<h2 id="cost">Cost</h2>
<p>Cost calculator for SimpleDB (<a href="http://calculator.s3.amazonaws.com/calc5.html#s=SIMPLEDB">http://calculator.s3.amazonaws.com/calc5.html#s=SIMPLEDB</a>).</p>
<p>If we have the same assumtions as for DynamoDB (see above) then we have:</p>
<ul>
<li>Number of Items - 30000000 (per month)</li>
<li>Average Number of Attributes Per Item - 5</li>
<li>Total Size of Attribute Values - 7GB</li>
<li>Number of BatchPuts - 30000000</li>
<li>Number of Gets - 30000000</li>
<li>Number of Simple Selects - 30000000</li>
<li>Data Transfer Out: - 7GB</li>
<li>Data Transfer In: - 7GB</li>
</ul>
<p>Calculated cost: $173.</p>
<h1 id="amazon-simpledb-vs-dynamodb">Amazon SimpleDB vs DynamoDB</h1>
<p>Q: How does Amazon DynamoDB differ from Amazon SimpleDB? Which should I use?
(<a href="http://aws.amazon.com/dynamodb/faqs/#How_does_Amazon_DynamoDB_differ_from_Amazon_SimpleDB_Which_should_I_use">http://aws.amazon.com/dynamodb/faqs/#How_does_Amazon_DynamoDB_differ_from_Amazon_SimpleDB_Which_should_I_use</a>)</p>
<pre><code><div class="highlight"><pre><span class="nx">Both</span> <span class="nx">services</span> <span class="nx">are</span> <span class="nx">non</span><span class="o">-</span><span class="nx">relational</span> <span class="nx">databases</span> <span class="nx">that</span> <span class="nx">remove</span> <span class="nx">the</span> <span class="nx">work</span> <span class="nx">of</span> <span class="nx">database</span>
<span class="nx">administration</span><span class="p">.</span> <span class="nx">Amazon</span> <span class="nx">DynamoDB</span> <span class="nx">focuses</span> <span class="nx">on</span> <span class="nx">providing</span> <span class="nx">seamless</span> <span class="nx">scalability</span> <span class="nx">and</span>
<span class="nx">fast</span><span class="p">,</span> <span class="nx">predictable</span> <span class="nx">performance</span><span class="p">.</span> <span class="nx">It</span> <span class="nx">runs</span> <span class="nx">on</span> <span class="nx">solid</span> <span class="nx">state</span> <span class="nx">disks</span> <span class="p">(</span><span class="nx">SSDs</span><span class="p">)</span> <span class="k">for</span>
<span class="nx">low</span><span class="o">-</span><span class="nx">latency</span> <span class="nx">response</span> <span class="nx">times</span><span class="p">,</span> <span class="nx">and</span> <span class="nx">there</span> <span class="nx">are</span> <span class="nx">no</span> <span class="nx">limits</span> <span class="nx">on</span> <span class="nx">the</span> <span class="nx">request</span> <span class="nx">capacity</span> <span class="nx">or</span>
<span class="nx">storage</span> <span class="nx">size</span> <span class="k">for</span> <span class="nx">a</span> <span class="nx">given</span> <span class="nx">table</span><span class="p">.</span> <span class="nx">This</span> <span class="nx">is</span> <span class="nx">because</span> <span class="nx">Amazon</span> <span class="nx">DynamoDB</span> <span class="nx">automatically</span>
<span class="nx">partitions</span> <span class="nx">your</span> <span class="nx">data</span> <span class="nx">and</span> <span class="nx">workload</span> <span class="nx">over</span> <span class="nx">a</span> <span class="nx">sufficient</span> <span class="nx">number</span> <span class="nx">of</span> <span class="nx">servers</span> <span class="nx">to</span> <span class="nx">meet</span>
<span class="nx">the</span> <span class="nx">scale</span> <span class="nx">requirements</span> <span class="nx">you</span> <span class="nx">provide</span><span class="p">.</span>
<span class="nx">In</span> <span class="nx">contrast</span><span class="p">,</span> <span class="nx">a</span> <span class="nx">table</span> <span class="k">in</span> <span class="nx">Amazon</span> <span class="nx">SimpleDB</span> <span class="nx">has</span> <span class="nx">a</span> <span class="nx">strict</span> <span class="nx">storage</span> <span class="nx">limitation</span> <span class="nx">of</span> <span class="mi">10</span>
<span class="nx">GB</span> <span class="nx">and</span> <span class="nx">is</span> <span class="nx">limited</span> <span class="k">in</span> <span class="nx">the</span> <span class="nx">request</span> <span class="nx">capacity</span> <span class="nx">it</span> <span class="nx">can</span> <span class="nx">achieve</span> <span class="p">(</span><span class="nx">typically</span> <span class="nx">under</span> <span class="mi">25</span>
<span class="nx">writes</span><span class="o">/</span><span class="nx">second</span><span class="p">);</span> <span class="nx">it</span> <span class="nx">is</span> <span class="nx">up</span> <span class="nx">to</span> <span class="nx">you</span> <span class="nx">to</span> <span class="nx">manage</span> <span class="nx">the</span> <span class="nx">partitioning</span> <span class="nx">and</span> <span class="nx">re</span><span class="o">-</span><span class="nx">partitioning</span>
<span class="nx">of</span> <span class="nx">your</span> <span class="nx">data</span> <span class="nx">over</span> <span class="nx">additional</span> <span class="nx">SimpleDB</span> <span class="nx">tables</span> <span class="k">if</span> <span class="nx">you</span> <span class="nx">need</span> <span class="nx">additional</span> <span class="nx">scale</span><span class="p">.</span>
<span class="nx">While</span> <span class="nx">SimpleDB</span> <span class="nx">has</span> <span class="nx">scaling</span> <span class="nx">limitations</span><span class="p">,</span> <span class="nx">it</span> <span class="nx">may</span> <span class="nx">be</span> <span class="nx">a</span> <span class="nx">good</span> <span class="nx">fit</span> <span class="k">for</span> <span class="nx">smaller</span>
<span class="nx">workloads</span> <span class="nx">that</span> <span class="nx">require</span> <span class="nx">query</span> <span class="nx">flexibility</span><span class="p">.</span> <span class="nx">Amazon</span> <span class="nx">SimpleDB</span> <span class="nx">automatically</span> <span class="nx">indexes</span>
<span class="nx">all</span> <span class="nx">item</span> <span class="nx">attributes</span> <span class="nx">and</span> <span class="nx">thus</span> <span class="nx">supports</span> <span class="nx">query</span> <span class="nx">flexibility</span> <span class="nx">at</span> <span class="nx">the</span> <span class="nx">cost</span> <span class="nx">of</span>
<span class="nx">performance</span> <span class="nx">and</span> <span class="nx">scale</span><span class="p">.</span>
</pre></div>

</code></pre><p>Note: in the DynamoDB there is also 10GB limitation for item collections (items
with the same hash key) if we use secondary indexes.</p>
<p>For events storage we have:</p>
<ul>
<li>query /filter data with different criteria: can be done with SimpleDB, much more complex with DynamoDB</li>
<li>sort data: yes for SimpleDB, no for DynamoDB (fixed sorting)</li>
<li>export data: complex for both, need to implement offline operation</li>
<li>response time / requests performane: much better for DynamoDB</li>
<li>table size limit and scaling: better for DynamoDB</li>
<li>cost: much higher for DynamoDB</li>
</ul>
<h2 id="additional-resources">Additional resources</h2>
<p><a href="http://www.quora.com/Amazon-DynamoDB/What-is-the-difference-between-SimpleDB-and-DynamoDB">Quora: What is the difference between SimpleDB and DynamoDB?</a></p>
<p><a href="http://stackoverflow.com/questions/8961333/amazon-simpledb-vs-amazon-dynamodb">Stackoverflow: Amazon SimpleDB vs Amazon DynamoDB</a></p>
<p><a href="http://stackoverflow.com/questions/9746702/amazon-simpledb-or-dynamodb">Stackoverflow: Amazon SimpleDB or DynamoDB</a></p>
<h1 id="general-resourses">General Resourses</h1>
<p><a href="http://www.syoncloud.com/big_data_technology_overview">Overview of Big Data and NoSQL Technologies as of January 2013</a></p>
<p><a href="http://highscalability.com/blog/2010/12/6/what-the-heck-are-you-actually-using-nosql-for.html">What The Heck Are You Actually Using NoSQL For?</a></p>
<p><a href="http://highscalability.com/scaling-twitter-making-twitter-10000-percent-faster">Scaling Twitter: Making Twitter 10000 Percent Faster</a></p>
<p><a href="http://stackoverflow.com/questions/9815234/how-to-store-7-3-billion-rows-of-market-data-optimized-to-be-read">Stackoverflow: How to store 7.3 billion rows of market data (optimized to be read)?</a></p>
<p><a href="http://aws.amazon.com/running_databases/">Running Databases on AWS</a></p>
<p><a href="http://aws.amazon.com/nosql/">Running NoSQL Databases on AWS</a></p>
<p><a href="http://www.metabrew.com/article/anti-rdbms-a-list-of-distributed-key-value-stores">Anti-RDBMS: A list of distributed key-value stores</a></p>
<p><a href="http://www.couchbase.com/why-nosql/nosql-database">CouchDB: Why NoSQL?</a></p>
<p><a href="http://perfcap.blogspot.com/2012/01/thoughts-on-simpledb-dynamodb-and.html">Thoughts on SimpleDB, DynamoDB and Cassandra</a></p>
<h2 id="some-other-nosql-solutions">Some Other NoSQL solutions</h2>
<p><a href="http://www.mongodb.org/">MongoDB</a> and <a href="http://docs.mongodb.org/manual/use-cases/storing-log-data/">MongoDB use cases: Storing log data</a>.</p>
<p><a href="http://d36cz9buwru1tt.cloudfront.net/AWS_NoSQL_MongoDB.pdf">MongoDB NoSQL Database on AWS</a>.</p>
<p><a href="http://cassandra.apache.org/">Cassandra</a> and <a href="http://wiki.apache.org/cassandra/UseCases">Cassandra use cases</a>.</p>
<p><a href="http://hypertable.com/why_hypertable/">Hypertable</a>.</p>
<p><a href="http://hbase.apache.org/">HBase</a>.</p>
<p><a href="http://couchdb.apache.org/">CouchDB</a>.</p>
<p><a href="http://voltdb.com/">VoltDB</a>.</p>
<p><a href="http://www.mysqlperformanceblog.com/2011/02/28/is-voltdb-really-as-scalable-as-they-claim/">Is VoltDB really as scalable as they claim?</a>.</p>
<p><a href="http://highscalability.com/blog/2010/6/28/voltdb-decapitates-six-sql-urban-myths-and-delivers-internet.html">VoltDB Decapitates Six SQL Urban Myths And Delivers Internet Scale OLTP In The Process</a>.</p>

          </div>
      </div>
      <div class="row">
          <div class="col-md-12">
<div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'serebrov'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
          </div>
      </div>
    </div>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <!--script src="/js/bootstrap.min.js"></script-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-58056088-1', 'auto');
  ga('send', 'pageview');

</script>
  </body>
</html>

